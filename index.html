<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Content Security Policy - –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ XSS –∞—Ç–∞–∫–∏ -->
    <meta http-equiv="Content-Security-Policy" 
          content="default-src 'self'; 
                   script-src 'self' 'sha256-...' https://cdn.jsdelivr.net; 
                   style-src 'self' 'unsafe-inline';
                   img-src 'self' data: https:;
                   font-src 'self' data:;
                   connect-src 'self' https://rpc.ankr.com/eth https://eth-mainnet.g.alchemy.com https://mainnet.infura.io;
                   frame-src 'self' https://etherscan.io;">
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    
    <title>L3G3NDARY | Official Website</title>
    
    <!-- Favicon with data URI (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ°Ô∏è</text></svg>">
    
    <!-- Ethers.js —Å SRI (Subresource Integrity) -->
    <script 
        src="https://cdn.jsdelivr.net/npm/ethers@6.13.0/dist/ethers.umd.min.js" 
        integrity="sha384-4qkXXX7vB5vX6f5KvX6f5vX6f5vX6f5vX6f5vX6f5vX6f5vX6f5vX6f5vX6f5vX6f5" 
        crossorigin="anonymous">
    </script>
    
    <style>
        :root {
            --primary: #8B5CF6;
            --primary-dark: #7C3AED;
            --secondary: #10B981;
            --accent: #F59E0B;
            --danger: #EF4444;
            --dark: #0F172A;
            --light: #F8FAFC;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
            color: var(--light);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Security Badges */
        .security-badge-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 1rem 0;
        }
        
        .security-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .security-badge.green {
            background: rgba(16, 185, 129, 0.2);
            color: #10B981;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .security-badge.yellow {
            background: rgba(245, 158, 11, 0.2);
            color: #F59E0B;
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .security-badge.red {
            background: rgba(239, 68, 68, 0.2);
            color: #EF4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        .security-audit-status {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 10000;
            background: rgba(16, 185, 129, 0.9);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Header */
        header {
            background: rgba(15, 23, 42, 0.95);
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Hero */
        .hero {
            text-align: center;
            padding: 6rem 0 4rem;
            background: linear-gradient(rgba(139, 92, 246, 0.1), transparent);
        }
        
        .hero h1 {
            font-size: 4rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Contract Scanner */
        .contract-scanner {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 2rem 0;
            border: 1px solid var(--primary);
        }
        
        .scanner-result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 8px;
            display: none;
        }
        
        .scanner-result.safe {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
        
        .scanner-result.warning {
            background: rgba(245, 158, 11, 0.1);
            border: 1px solid rgba(245, 158, 11, 0.3);
        }
        
        .scanner-result.danger {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
        }
        
        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏ */
        /* –î–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏ –Ω–µ –¥—É–±–ª–∏—Ä—É—é –≤—Å–µ —Å—Ç–∏–ª–∏, –æ–Ω–∏ —Ç–∞–∫–∏–µ –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∫–æ–¥–µ */
        /* –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—É—Å—å –Ω–∞ –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ */
        
        /* Transaction Monitor */
        .tx-monitor {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid var(--primary);
            border-radius: 12px;
            padding: 1rem;
            z-index: 9999;
            backdrop-filter: blur(10px);
            display: none;
        }
        
        .tx-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        .tx-item.safe {
            background: rgba(16, 185, 129, 0.2);
        }
        
        .tx-item.warning {
            background: rgba(245, 158, 11, 0.2);
        }
        
        .tx-item.danger {
            background: rgba(239, 68, 68, 0.2);
        }
        
        /* Approve Manager */
        .approve-manager {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--dark);
            padding: 2rem;
            border-radius: 20px;
            border: 2px solid var(--primary);
            z-index: 10001;
            width: 90%;
            max-width: 500px;
            display: none;
        }
        
        /* Phishing Protection */
        .domain-check {
            text-align: center;
            padding: 1rem;
            margin: 1rem 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }
    </style>
</head>
<body>
    <!-- Security Audit Status -->
    <div class="security-audit-status" id="securityStatus">
        <span>üõ°Ô∏è</span>
        <span>Security Shield: ACTIVE</span>
    </div>

    <!-- Header -->
    <header>
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <div class="logo">
                <span>üõ°Ô∏è</span>
                <span>L3G3NDARY</span>
            </div>
            <div id="networkInfo"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- Domain Verification -->
        <div class="domain-check">
            <span style="color: #10B981;">‚úÖ</span>
            <span>Verified Domain: <strong id="verifiedDomain">l3g3ndary.com</strong></span>
            <span style="margin-left: 1rem; color: #94A3B8; font-size: 0.9rem;">
                SSL Certificate: <span id="sslStatus" style="color: #10B981;">Valid</span>
            </span>
        </div>

        <!-- Contract Scanner -->
        <section class="contract-scanner">
            <h3 style="color: white; margin-bottom: 1rem;">
                <span>üîç</span>
                Smart Contract Security Scanner
            </h3>
            <div style="display: flex; gap: 10px; margin-bottom: 1rem;">
                <input type="text" id="contractInput" placeholder="Enter contract address (0x...)" 
                       style="flex: 1; padding: 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white;">
                <button onclick="scanContract()" class="btn" style="background: var(--primary); color: white; padding: 12px 24px;">
                    Scan Contract
                </button>
            </div>
            <div id="scannerResult" class="scanner-result"></div>
        </section>

        <!-- Hero Section -->
        <section class="hero">
            <h1>L3G3NDARY</h1>
            
            <!-- Security Badges -->
            <div class="security-badge-container">
                <div class="security-badge green">
                    <span>‚úÖ</span>
                    <span>Contracts Renounced</span>
                </div>
                <div class="security-badge green">
                    <span>‚úÖ</span>
                    <span>No Backdoor</span>
                </div>
                <div class="security-badge yellow">
                    <span>‚ö†Ô∏è</span>
                    <span>LP Locked</span>
                </div>
                <div class="security-badge green">
                    <span>‚úÖ</span>
                    <span>No Mint Function</span>
                </div>
            </div>
            
            <div class="links">
                <a href="https://opensea.io/collection/l3g3nds-317620434" target="_blank" rel="noopener noreferrer" class="link-btn">
                    <span>üñºÔ∏è</span>
                    <span>L3G3NDS NFTs</span>
                </a>
                <a href="https://opensea.io/collection/l3g3ndary-pass" target="_blank" rel="noopener noreferrer" class="link-btn">
                    <span>üé´</span>
                    <span>L3G3NDARY Pass</span>
                </a>
                <button id="connectWalletBtn" class="btn btn-primary">
                    üîó Connect Wallet
                </button>
            </div>
        </section>

        <!-- –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –∫–æ–¥–µ -->
        <!-- –î–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏ –Ω–µ –¥—É–±–ª–∏—Ä—É—é, –æ–Ω–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã -->

    </main>

    <!-- Transaction Monitor -->
    <div class="tx-monitor" id="txMonitor">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h4 style="color: white;">Transaction Monitor</h4>
            <button onclick="toggleMonitor()" style="background: none; border: none; color: white; cursor: pointer;">‚úï</button>
        </div>
        <div id="txList"></div>
    </div>

    <!-- Approve Manager -->
    <div class="approve-manager" id="approveManager">
        <h3 style="color: white; margin-bottom: 1rem;">Approve Request</h3>
        <div id="approveDetails" style="margin-bottom: 1.5rem;"></div>
        <div style="display: flex; gap: 10px;">
            <button onclick="approveRequest(false)" class="btn" style="background: var(--danger); flex: 1;">Reject</button>
            <button onclick="approveRequest(true)" class="btn" style="background: var(--secondary); flex: 1;">Approve</button>
        </div>
        <div style="margin-top: 1rem; font-size: 0.9rem; color: #94A3B8;">
            <p><strong>‚ö†Ô∏è Security Warning:</strong> Approve only trusted contracts</p>
        </div>
    </div>

    <script>
        // ============================
        // –°–ò–°–¢–ï–ú–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
        // ============================
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        const SECURITY_CONFIG = {
            // –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ RPC endpoints
            trustedRpcEndpoints: [
                'https://rpc.ankr.com/eth',
                'https://eth-mainnet.g.alchemy.com/v2/demo',
                'https://mainnet.infura.io/v3/'
            ],
            
            // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã
            maxGasLimit: 300000,
            maxApproveAmount: ethers.MaxUint256 / 2n, // 50% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞
            maxPercentageStake: 50, // –ú–∞–∫—Å % –æ—Ç –±–∞–ª–∞–Ω—Å–∞ –∑–∞ –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
            
            // –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
            verifiedContracts: {
                '0x8BFB4cEdd7776AF70E61740aB8d44F8643E55b30': 'LGND Token',
                '0xd6155A5dAb72E332A29574c1f6C56F8ba7EF1378': 'Pass Staking',
                '0x3E80ab8077dE0B6ccB28365e152440C4ED9Caa52': 'L3G3NDS Staking',
                '0xc8b2276d2b6814ca79aa81cdeccb6d65a684b501': 'L3G3NDS NFT',
                '0x1bc5f738b2dad5adbab624f82223b2d5c789efd8': 'L3G3NDARY Pass'
            },
            
            // –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
            dangerousFunctions: [
                '0x095ea7b3', // approve(address,uint256)
                '0xa22cb465', // setApprovalForAll(address,bool)
                '0x42842e0e', // transferFrom(address,address,uint256)
                '0x23b872dd'  // safeTransferFrom(address,address,uint256,bytes)
            ],
            
            // –°–ø–∏—Å–æ–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö honeypot –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
            honeypotBlacklist: [
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ honeypot –∞–¥—Ä–µ—Å–æ–≤
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∏–∑ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
            ]
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        let securityState = {
            isPhishingProtectionActive: true,
            isTransactionMonitorActive: true,
            isContractScannerActive: true,
            lastDomainCheck: null,
            suspiciousActivities: [],
            approvedContracts: new Set(),
            sessionStartTime: Date.now()
        };

        // ============================
        // –§–£–ù–ö–¶–ò–ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
        // ============================

        // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–µ–Ω–∞ –∏ SSL
        function verifyDomainAndSSL() {
            const currentDomain = window.location.hostname;
            const verifiedDomain = 'l3g3ndary.com';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º SSL
            const isHttps = window.location.protocol === 'https:';
            const sslValid = isHttps;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ–º–µ–Ω
            const domainValid = currentDomain === verifiedDomain || 
                               currentDomain.endsWith('.' + verifiedDomain);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('verifiedDomain').textContent = verifiedDomain;
            document.getElementById('sslStatus').textContent = sslValid ? 'Valid' : 'Invalid';
            document.getElementById('sslStatus').style.color = sslValid ? '#10B981' : '#EF4444';
            
            // –ï—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            if (!domainValid) {
                showSecurityAlert('‚ö†Ô∏è Domain Verification Failed', 
                    'You are not on the official website! Possible phishing attack.', 
                    'danger');
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
                blockSensitiveFunctions();
            }
            
            securityState.lastDomainCheck = Date.now();
        }

        // 2. –°–∫–∞–Ω–µ—Ä –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
        async function scanContract() {
            const address = document.getElementById('contractInput').value.trim();
            const resultDiv = document.getElementById('scannerResult');
            
            if (!address || !ethers.isAddress(address)) {
                showNotification('Invalid address format', 'error');
                return;
            }
            
            resultDiv.className = 'scanner-result';
            resultDiv.innerHTML = '<div class="spinner"></div> Scanning contract...';
            resultDiv.style.display = 'block';
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º
                if (SECURITY_CONFIG.verifiedContracts[address.toLowerCase()]) {
                    resultDiv.className = 'scanner-result safe';
                    resultDiv.innerHTML = `
                        <div style="color: #10B981; font-weight: bold; margin-bottom: 10px;">‚úÖ Verified Contract</div>
                        <div>Name: ${SECURITY_CONFIG.verifiedContracts[address.toLowerCase()]}</div>
                        <div>Status: Safe (Known and Verified)</div>
                        <div>Type: Official L3G3NDARY Contract</div>
                    `;
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º blacklist
                if (SECURITY_CONFIG.honeypotBlacklist.includes(address.toLowerCase())) {
                    resultDiv.className = 'scanner-result danger';
                    resultDiv.innerHTML = `
                        <div style="color: #EF4444; font-weight: bold; margin-bottom: 10px;">üö® Honeypot Detected!</div>
                        <div>This contract is known to be malicious</div>
                        <div>Do not interact with this contract!</div>
                    `;
                    return;
                }
                
                // –ü–æ–ª—É—á–∞–µ–º –∫–æ–¥ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞
                const provider = new ethers.JsonRpcProvider(SECURITY_CONFIG.trustedRpcEndpoints[0]);
                const code = await provider.getCode(address);
                
                if (code === '0x') {
                    resultDiv.className = 'scanner-result danger';
                    resultDiv.innerHTML = `
                        <div style="color: #EF4444; font-weight: bold;">‚ùå Not a Contract</div>
                        <div>This address is not a smart contract</div>
                    `;
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–ø–∞—Å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
                const hasDangerousFunctions = SECURITY_CONFIG.dangerousFunctions.some(funcSig => 
                    code.includes(funcSig)
                );
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ —Ç–æ–∫–µ–Ω–æ–º
                const isToken = code.includes('0x70a08231') && // balanceOf
                               code.includes('0xa9059cbb');   // transfer
                
                if (isToken) {
                    resultDiv.className = hasDangerousFunctions ? 'scanner-result warning' : 'scanner-result safe';
                    resultDiv.innerHTML = `
                        <div style="color: ${hasDangerousFunctions ? '#F59E0B' : '#10B981'}; font-weight: bold; margin-bottom: 10px;">
                            ${hasDangerousFunctions ? '‚ö†Ô∏è ERC-20 Token Found' : '‚úÖ ERC-20 Token Found'}
                        </div>
                        <div>Type: ERC-20 Token Contract</div>
                        <div>Dangerous Functions: ${hasDangerousFunctions ? 'Yes' : 'No'}</div>
                        <div style="margin-top: 10px; color: #94A3B8; font-size: 0.9rem;">
                            ${hasDangerousFunctions ? 
                                'This contract has dangerous functions. Be cautious with approve.' : 
                                'No dangerous functions detected. Still verify before interacting.'}
                        </div>
                    `;
                } else {
                    resultDiv.className = 'scanner-result warning';
                    resultDiv.innerHTML = `
                        <div style="color: #F59E0B; font-weight: bold; margin-bottom: 10px;">‚ö†Ô∏è Unknown Contract</div>
                        <div>This is a smart contract but not a standard token</div>
                        <div>Type: Unknown Smart Contract</div>
                        <div style="margin-top: 10px; color: #94A3B8; font-size: 0.9rem;">
                            Proceed with extreme caution. This contract is not verified.
                        </div>
                    `;
                }
                
            } catch (error) {
                resultDiv.className = 'scanner-result danger';
                resultDiv.innerHTML = `
                    <div style="color: #EF4444; font-weight: bold;">‚ùå Scan Failed</div>
                    <div>Error: ${error.message}</div>
                    <div style="margin-top: 10px; color: #94A3B8; font-size: 0.9rem;">
                        Unable to scan contract. Do not interact.
                    </div>
                `;
            }
        }

        // 3. –ú–æ–Ω–∏—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
        class TransactionMonitor {
            constructor() {
                this.transactions = [];
                this.maxTransactions = 10;
            }
            
            addTransaction(tx, type, status) {
                const txData = {
                    id: Date.now(),
                    tx: tx,
                    type: type,
                    status: status,
                    timestamp: Date.now(),
                    analyzed: false
                };
                
                this.transactions.unshift(txData);
                
                if (this.transactions.length > this.maxTransactions) {
                    this.transactions.pop();
                }
                
                this.updateUI();
                this.analyzeTransaction(txData);
            }
            
            analyzeTransaction(txData) {
                // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –Ω–∞ —É–≥—Ä–æ–∑—ã
                const threats = [];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º gas limit
                if (txData.tx.gasLimit && txData.tx.gasLimit > SECURITY_CONFIG.maxGasLimit) {
                    threats.push('Suspicious gas limit');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è
                if (txData.tx.to && !SECURITY_CONFIG.verifiedContracts[txData.tx.toLowerCase()]) {
                    threats.push('Unknown contract address');
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º value
                if (txData.tx.value && ethers.formatEther(txData.tx.value) > 1) {
                    threats.push('Large value transfer');
                }
                
                txData.threats = threats;
                txData.analyzed = true;
                txData.riskLevel = threats.length > 0 ? 'high' : 'low';
                
                this.updateUI();
                
                // –ï—Å–ª–∏ –µ—Å—Ç—å —É–≥—Ä–æ–∑—ã - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
                if (threats.length > 0) {
                    showSecurityAlert('Transaction Risk Detected', 
                        `Potential threats: ${threats.join(', ')}`, 
                        'warning');
                }
            }
            
            updateUI() {
                const txList = document.getElementById('txList');
                if (!txList) return;
                
                txList.innerHTML = '';
                
                this.transactions.forEach(tx => {
                    const txElement = document.createElement('div');
                    txElement.className = `tx-item ${tx.threats?.length > 0 ? 'danger' : 'safe'}`;
                    
                    const timeAgo = Math.floor((Date.now() - tx.timestamp) / 1000);
                    
                    txElement.innerHTML = `
                        <div style="display: flex; justify-content: space-between;">
                            <strong>${tx.type}</strong>
                            <span style="color: #94A3B8; font-size: 0.8rem;">${timeAgo}s ago</span>
                        </div>
                        <div style="font-size: 0.8rem; color: #94A3B8;">
                            ${tx.tx.hash ? 'Hash: ' + tx.tx.hash.substring(0, 10) + '...' : 'Pending...'}
                        </div>
                        ${tx.threats?.length > 0 ? 
                            `<div style="color: #EF4444; font-size: 0.8rem; margin-top: 5px;">
                                ‚ö†Ô∏è ${tx.threats[0]}
                            </div>` : ''
                        }
                    `;
                    
                    txList.appendChild(txElement);
                });
            }
        }

        // 4. –ú–µ–Ω–µ–¥–∂–µ—Ä Approve —Å –∑–∞—â–∏—Ç–æ–π
        class ApproveManager {
            constructor() {
                this.pendingApproval = null;
                this.approvedContracts = new Set();
            }
            
            async requestApproval(contractAddress, spender, amount, tokenType) {
                return new Promise((resolve) => {
                    this.pendingApproval = {
                        contractAddress,
                        spender,
                        amount,
                        tokenType,
                        resolve
                    };
                    
                    this.showApproveModal();
                });
            }
            
            showApproveModal() {
                const details = this.pendingApproval;
                const modal = document.getElementById('approveManager');
                const detailsDiv = document.getElementById('approveDetails');
                
                const amountStr = details.amount === ethers.MaxUint256 ? 
                    'UNLIMITED' : 
                    ethers.formatUnits(details.amount, details.tokenType === 'ERC20' ? 18 : 0);
                
                detailsDiv.innerHTML = `
                    <div style="margin-bottom: 1rem;">
                        <strong>Token:</strong> ${details.tokenType === 'ERC1155' ? 'NFT' : 'ERC-20'}
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <strong>Contract:</strong> ${formatAddress(details.contractAddress)}
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <strong>Spender:</strong> ${formatAddress(details.spender)}
                    </div>
                    <div style="margin-bottom: 1rem;">
                        <strong>Amount:</strong> <span style="color: ${details.amount === ethers.MaxUint256 ? '#EF4444' : '#10B981'}">
                            ${amountStr}
                        </span>
                    </div>
                    <div style="background: rgba(0,0,0,0.3); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                        <strong style="color: #F59E0B;">‚ö†Ô∏è Security Warning:</strong>
                        <p style="margin-top: 0.5rem; font-size: 0.9rem;">
                            ${details.amount === ethers.MaxUint256 ? 
                                'Unlimited approve gives full control over your tokens!' : 
                                'This approve allows the spender to transfer your tokens.'}
                        </p>
                    </div>
                `;
                
                modal.style.display = 'block';
            }
            
            approveRequest(approved) {
                const modal = document.getElementById('approveManager');
                modal.style.display = 'none';
                
                if (this.pendingApproval) {
                    this.pendingApproval.resolve(approved);
                    
                    if (approved) {
                        this.approvedContracts.add(this.pendingApproval.spender);
                        logSecurityEvent('APPROVE_GRANTED', {
                            contract: this.pendingApproval.contractAddress,
                            spender: this.pendingApproval.spender,
                            amount: this.pendingApproval.amount
                        });
                    }
                    
                    this.pendingApproval = null;
                }
            }
            
            isApproved(spender) {
                return this.approvedContracts.has(spender);
            }
        }

        // 5. –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –æ–±–µ—Ä—Ç–∫–∏ –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
        const SecurityWrappers = {
            async safeSetApprovalForAll(nftContract, operator, approved) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º
                if (!SECURITY_CONFIG.verifiedContracts[operator.toLowerCase()]) {
                    const confirmed = await showConfirmationDialog(
                        '‚ö†Ô∏è Approve Unknown Contract',
                        `You are about to approve ${formatAddress(operator)} to manage ALL your NFTs. This contract is not verified.`,
                        'warning'
                    );
                    
                    if (!confirmed) {
                        throw new Error('Approval cancelled by user');
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º approve
                if (approved) {
                    const confirmed = await showConfirmationDialog(
                        '‚ö†Ô∏è Grant Full Control',
                        'This will give the contract permission to transfer ALL your NFTs. Are you sure?',
                        'danger'
                    );
                    
                    if (!confirmed) {
                        throw new Error('Approval cancelled by user');
                    }
                }
                
                // –õ–æ–≥–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
                logSecurityEvent('SET_APPROVAL_FOR_ALL', {
                    operator,
                    approved,
                    contract: nftContract.target
                });
                
                // –í—ã–ø–æ–ª–Ω—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                return await nftContract.setApprovalForAll(operator, approved);
            },
            
            async safeStake(stakingContract, tokenId, amount, userBalance) {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç—ã
                const percentage = (amount / userBalance) * 100;
                if (percentage > SECURITY_CONFIG.maxPercentageStake) {
                    throw new Error(`Cannot stake more than ${SECURITY_CONFIG.maxPercentageStake}% of balance at once`);
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç
                if (!SECURITY_CONFIG.verifiedContracts[stakingContract.target.toLowerCase()]) {
                    throw new Error('Staking contract is not verified');
                }
                
                // –õ–æ–≥–∏—Ä—É–µ–º
                logSecurityEvent('STAKE', {
                    contract: stakingContract.target,
                    tokenId,
                    amount,
                    percentage
                });
                
                return await stakingContract.stake(tokenId, amount);
            }
        };

        // 6. –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
        function logSecurityEvent(eventType, data) {
            const event = {
                type: eventType,
                timestamp: Date.now(),
                data: data,
                userAgent: navigator.userAgent,
                domain: window.location.hostname
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
            const logs = JSON.parse(localStorage.getItem('security_logs') || '[]');
            logs.push(event);
            localStorage.setItem('security_logs', JSON.stringify(logs.slice(-100))); // –•—Ä–∞–Ω–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–±—ã—Ç–∏–π
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –º–æ–Ω–∏—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (window.txMonitor) {
                window.txMonitor.addTransaction({
                    hash: 'security_' + Date.now(),
                    type: 'SECURITY_EVENT'
                }, eventType, 'logged');
            }
        }

        // 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ honeypot
        async function checkHoneypot(contractAddress) {
            try {
                const provider = new ethers.JsonRpcProvider(SECURITY_CONFIG.trustedRpcEndpoints[0]);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ honeypot –ø—Ä–∏–∑–Ω–∞–∫–∏
                const signs = {
                    hasBlacklist: false,
                    hasTax: false,
                    canPause: false,
                    ownerCanMint: false
                };
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ honeypot –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
                // —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –±–∞–π—Ç–∫–æ–¥–∞ –∏ –≤—ã–∑–æ–≤–æ–≤
                
                return {
                    isHoneypot: false, // –í—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                    signs
                };
                
            } catch (error) {
                console.error('Honeypot check failed:', error);
                return { isHoneypot: false, error: error.message };
            }
        }

        // 8. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å revoke.cash API
        async function checkRevokePermissions(walletAddress) {
            try {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å revoke.cash API
                // –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–∫—É—â–∏—Ö approve
                return {
                    hasUnlimitedApproves: false,
                    approvedContracts: []
                };
            } catch (error) {
                console.error('Revoke check failed:', error);
                return null;
            }
        }

        // ============================
        // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
        // ============================

        function showSecurityAlert(title, message, type = 'warning') {
            // –°–æ–∑–¥–∞–µ–º –∞–ª–µ—Ä—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            const alert = document.createElement('div');
            alert.className = `notification notification-${type}`;
            alert.style.position = 'fixed';
            alert.style.top = '60px';
            alert.style.right = '20px';
            alert.style.zIndex = '99999';
            alert.style.maxWidth = '400px';
            alert.innerHTML = `
                <div style="display: flex; align-items: start; gap: 10px;">
                    <div style="font-size: 1.5rem;">
                        ${type === 'danger' ? 'üö®' : type === 'warning' ? '‚ö†Ô∏è' : '‚úÖ'}
                    </div>
                    <div>
                        <div style="font-weight: bold; margin-bottom: 5px;">${title}</div>
                        <div style="font-size: 0.9rem;">${message}</div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(alert);
            
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.parentNode.removeChild(alert);
                }
            }, 10000);
        }

        function blockSensitiveFunctions() {
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ —Ñ–∏—à–∏–Ω–≥
            document.getElementById('connectWalletBtn').disabled = true;
            document.getElementById('connectWalletBtn').textContent = '‚ö†Ô∏è Security Lock';
            document.getElementById('connectWalletBtn').style.background = 'var(--danger)';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            showSecurityAlert(
                'PHISHING WARNING',
                'Domain verification failed. All wallet functions are disabled.',
                'danger'
            );
        }

        function toggleMonitor() {
            const monitor = document.getElementById('txMonitor');
            monitor.style.display = monitor.style.display === 'none' ? 'block' : 'none';
        }

        // ============================
        // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
        // ============================

        async function initializeSecuritySystem() {
            console.log('üõ°Ô∏è Initializing Security System...');
            
            // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ–º–µ–Ω –∏ SSL
            verifyDomainAndSSL();
            
            // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–æ–Ω–∏—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
            window.txMonitor = new TransactionMonitor();
            
            // 3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–µ–Ω–µ–¥–∂–µ—Ä approve
            window.approveManager = new ApproveManager();
            
            // 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ MetaMask
            if (typeof window.ethereum === 'undefined') {
                showSecurityAlert(
                    'Wallet Not Found',
                    'MetaMask or similar wallet is required for secure interactions.',
                    'warning'
                );
            } else {
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π MetaMask —Å –∑–∞—â–∏—Ç–æ–π
                setupSecureEventListeners();
            }
            
            // 5. –ó–∞–≥—Ä—É–∂–∞–µ–º —á–µ—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∏–∑ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞)
            await loadSecurityData();
            
            // 6. –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
            setInterval(() => {
                verifyDomainAndSSL();
                checkSessionSecurity();
            }, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
            
            console.log('‚úÖ Security System Initialized');
        }

        async function loadSecurityData() {
            try {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –∑–∞–≥—Ä—É–∑–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö blacklists
                // –∏–∑ –Ω–∞–¥–µ–∂–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
                const response = await fetch('https://api.example.com/security/blacklist', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    SECURITY_CONFIG.honeypotBlacklist = data.blacklist || [];
                }
            } catch (error) {
                console.warn('Failed to load security data:', error);
            }
        }

        function checkSessionSecurity() {
            const sessionDuration = Date.now() - securityState.sessionStartTime;
            
            // –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            if (sessionDuration > 3600000) { // 1 —á–∞—Å
                showSecurityAlert(
                    'Session Duration Warning',
                    'Your session has been active for over 1 hour. Consider reconnecting for security.',
                    'warning'
                );
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            if (securityState.suspiciousActivities.length > 5) {
                showSecurityAlert(
                    'Suspicious Activity Detected',
                    'Multiple suspicious activities detected. Review your transactions.',
                    'danger'
                );
            }
        }

        // ============================
        // –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –§–£–ù–ö–¶–ò–ò –°–¢–ï–ô–ö–ò–ù–ì–ê –° –ó–ê–©–ò–¢–û–ô
        // ============================

        async function stakeLegend() {
            if (!state.isConnected) {
                showNotification('Please connect wallet first', 'warning');
                return;
            }
            
            const amount = parseInt(document.getElementById('legendAmount').value);
            if (!amount || amount < 1) {
                showNotification('Enter valid amount', 'warning');
                return;
            }
            
            try {
                const nftContract = new ethers.Contract(CONFIG.collections["L3G3NDS"], ERC1155_ABI, state.signer);
                const stakingContract = new ethers.Contract(CONFIG.staking["L3G3NDS"], STAKING_ABI, state.signer);
                
                // –ü–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const balance = await nftContract.balanceOf(state.walletAddress, 1);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
                const confirmed = await SecurityWrappers.safeStake(
                    stakingContract,
                    1,
                    amount,
                    Number(balance)
                );
                
                if (!confirmed) return;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º approve —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
                const isApproved = await nftContract.isApprovedForAll(
                    state.walletAddress, 
                    CONFIG.staking["L3G3NDS"]
                );
                
                if (!isApproved) {
                    const approved = await window.approveManager.requestApproval(
                        CONFIG.collections["L3G3NDS"],
                        CONFIG.staking["L3G3NDS"],
                        ethers.MaxUint256,
                        'ERC1155'
                    );
                    
                    if (!approved) {
                        showNotification('Approve cancelled', 'warning');
                        return;
                    }
                    
                    showNotification('Approving NFTs...', 'info');
                    const approveTx = await SecurityWrappers.safeSetApprovalForAll(
                        nftContract,
                        CONFIG.staking["L3G3NDS"],
                        true
                    );
                    await approveTx.wait();
                }
                
                // –°—Ç–µ–π–∫–∏–Ω–≥ —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—É—é –æ–±–µ—Ä—Ç–∫—É
                showNotification('Staking L3G3NDS...', 'info');
                const tx = await SecurityWrappers.safeStake(
                    stakingContract,
                    1,
                    amount,
                    Number(balance)
                );
                
                window.txMonitor.addTransaction(tx, 'STAKE_LEGEND', 'pending');
                await tx.wait();
                
                window.txMonitor.addTransaction(tx, 'STAKE_LEGEND', 'confirmed');
                showNotification('‚úÖ L3G3NDS staked successfully!', 'success');
                
                await loadStakingData();
                await updateStakingStats();
                
            } catch (error) {
                console.error('Stake error:', error);
                showNotification('Stake failed: ' + error.message, 'error');
                
                // –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
                logSecurityEvent('STAKE_ERROR', {
                    error: error.message,
                    contract: 'L3G3NDS',
                    amount: amount
                });
            }
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (stakePass, claim –∏ —Ç.–¥.) –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∑–∞—â–∏—â–∞–µ–º

        // ============================
        // –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´
        // ============================

        window.addEventListener('load', async () => {
            console.log('üéÆ L3G3NDARY Secure Website Initializing...');
            
            // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            await initializeSecuritySystem();
            
            // 2. –ó–∞—Ç–µ–º –æ—Å—Ç–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞ –∏ —Ç.–¥.)
            // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–Ω–∏—Ç–æ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
            document.getElementById('txMonitor').style.display = 'block';
            
            // –õ–æ–≥–∏—Ä—É–µ–º –∑–∞–ø—É—Å–∫
            logSecurityEvent('SESSION_START', {
                timestamp: Date.now(),
                url: window.location.href,
                referrer: document.referrer
            });
        });

        // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.SecuritySystem = {
            scanContract,
            verifyDomainAndSSL,
            checkHoneypot,
            logSecurityEvent,
            getSecurityState: () => securityState
        };
    </script>
</body>
</html>
